-- Schema
--Tables

CREATE TABLE menu (
	menu_id INT NOT NULL PRIMARY KEY AUTO_INCREMENT, 
	name VARCHAR(25) NOT NULL,
	price DECIMAL(5,2) NOT NULL CHECK(Price>=0),
	cuisine_type VARCHAR(25),
	description VARCHAR(500),
	offer DECIMAL(5,2) NOT NULL CHECK(Offer<=1 AND Offer>=0),
	picture VarChar(100),
	visible BOOLEAN NOT NULL
	);

CREATE TABLE Users(
	userId INT PRIMARY KEY,
	UserName VARCHAR(25) UNIQUE NOT NULL,
	Hash VARCHAR(100) NOT NULL,
	Email VARCHAR(25),
	Address VARCHAR (100),
	IsAdmin BOOLEAN NOT NULL
	);

CREATE TABLE Orders(
	OrderNumber INT PRIMARY KEY,
	UserId INT,
	 	CONSTRAINT fk_order_user_id
		FOREIGN KEY (UserId) REFERENCES Users(UserId),
	OrderTime DATETIME,
	Cost DECIMAL(5,2) CHECK(Cost>=0)
	);

CREATE TABLE OrderHistory(
	OHKey INT PRIMARY KEY,
	OrderNumber INT,
		CONSTRAINT fk_oh_order_id
		FOREIGN KEY (OrderNumber) REFERENCES Orders(OrderNumber),
	Item INT,
		CONSTRAINT fk_oh_item_id
		FOREIGN KEY (Item) REFERENCES Menu(MenuID),
	Quantity INT CHECK(Quantity>0)
	);

CREATE TABLE Cart(
	CartIndex INT PRIMARY KEY,
	Item INT,
		CONSTRAINT fk_cart_item_id
		FOREIGN KEY (Item) REFERENCES Menu(MenuID),
	Quantity INT CHECK(Quantity>0)
	);

--Sequences
CREATE SEQUENCE sequence_Menu
START WITH 0
INCREMENT BY 1;

CREATE SEQUENCE sequence_User
START WITH 0
INCREMENT BY 1;

CREATE SEQUENCE sequence_Orders
START WITH 0
INCREMENT BY 1;

CREATE SEQUENCE sequence_OrderHistory
START WITH 0
INCREMENT BY 1;

CREATE SEQUENCE sequence_Cart
START WITH 0
INCREMENT BY 1;