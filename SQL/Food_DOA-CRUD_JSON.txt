//DOA CRUD JSON Code

// View menu ordered by Cuisine
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer AS CurrentPrice, Cuisine, Description FROM Menu WHERE Visible=TRUE ORDER BY Cuisine ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

// View menu ordered by Price acending
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer AS CurrentPrice, Cuisine, Description FROM Menu WHERE Visible=TRUE ORDER BY CurrentPrice ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

// View menu ordered by Price decending
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer AS CurrentPrice, Cuisine, Description FROM Menu WHERE Visible=TRUE ORDER BY CurrentPrice DESC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

// View menu ordered by Discount Acending
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer AS CurrentPrice, Cuisine, Description FROM Menu WHERE Visible=TRUE ORDER BY PercebtOff ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

// View menu ordered by Discount Descending
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer AS CurrentPrice, Cuisine, Description FROM Menu WHERE Visible=TRUE ORDER BY PercebtOff DESC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/* search for keyword and View menu ordered by Cuisine 
	Take in String keyword as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE(Name LIKE %"+Param+"% OR Cuisine="+Param+"% OR Description LIKE %"+Param+"%) AND Visible=TRUE ORDER BY Cuisine ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}
/* search for keyword and View menu ordered by Price Ascending 
	Take in String keyword as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE(Name LIKE %"+Param+"% OR Cuisine="+Param+"% OR Description LIKE %"+Param+"%) AND Visible=TRUE ORDER BY Price ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/* search for keyword and View menu ordered by Price Descending 
	Take in String keyword as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE(Name LIKE %"+Param+"% OR Cuisine="+Param+"% OR Description LIKE %"+Param+"%) AND Visible=TRUE ORDER BY Price DESC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/* search for keyword and View menu ordered by Discount Ascending 
	Take in String keyword as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE(Name LIKE %"+Param+"% OR Cuisine="+Param+"% OR Description LIKE %"+Param+"%) AND Visible=TRUE ORDER BY PercentOff ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/* search for keyword and View menu ordered by Discount Descending 
	Take in String keyword as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE(Name LIKE %"+Param+"% OR Cuisine="+Param+"% OR Description LIKE %"+Param+"%) AND Visible=TRUE ORDER BY PercentOff DESC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/*View 1 cuisine on menu 
	Take in String Cuisine as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE Cuisine="+Param+" AND Visible=TRUE";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/*View 1 cuisine on menu ordered by price Ascending
	Take in String Cuisine as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE Cuisine="+Param+" AND Visible=TRUE ORDER BY Price ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/*View 1 cuisine on menu ordered by price Descending
	Take in String Cuisine as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE Cuisine="+Param+" AND Visible=TRUE ORDER BY Price DESC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/*View 1 cuisine on menu ordered by Discount Ascending
	Take in String Cuisine as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE Cuisine="+Param+" AND Visible=TRUE ORDER BY PercentOff ASC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}

/*View 1 cuisine on menu ordered by Discount Descending
	Take in String Cuisine as Param variable*/	
public static String ViewMenuCuisine(Connection con) throws SQLException {
    String query = "SELECT Name, Price, (1-Offer)*100 AS PercentOff, Price*Offer as CurrentPrice, Cuisine, Description FROM Menu WHERE Cuisine="+Param+" AND Visible=TRUE ORDER BY PercentOff DESC";
    try (Statement stmt = con.createStatement()) {
      ResultSet rs = stmt.executeQuery(query);
      while (rs.next()) {
		String name = rs.getString("Name");
		float price = rs.getFloat("Price");
		float discount = rs.getFloat("PercentOff");
		float CurrentPrice= rs.getFloat("CurrentPrice");
		String Cuisine = rs.getString("Cuisine");
		String Descr = rs.getString("Description");
        return (name + "," + price + "," + discount +
                    "," + CurrentPrice + "," + Cuisine + "," + Descr);
      }
    } catch (SQLException e) {
      JDBCTutorialUtilities.printSQLException(e);
    }
}